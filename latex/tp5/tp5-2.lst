C:\Documents and Settings\micro\Mes documents\µC\dubus\tp5\tp5-2.lst - generated by MGTEK Assembler ASM12 V1.26 Build 144 for WIN32 (x86) - Thu Oct 11 01:23:25 2012

    1:          =00001000                   CODE    EQU     $1000
    2:          =00002000                   DATA    EQU     $2000
    3:          =00000040                   TIOS    EQU     $0040
    4:          =00000046                   TSCR1   EQU     $0046
    5:          =0000004D                   TSCR2   EQU     $004D
    6:          =00000048                   TCTL1   EQU     $0048
    7:          =00000049                   TCTL2   EQU     $0049
    8:          =0000004A                   TCTL3   EQU     $004A
    9:          =0000004B                   TCTL4   EQU     $004B
   10:          =0000004E                   TFLG1   EQU     $004E
   11:          =00000044                   TCNT    EQU     $0044
   12:          =00000054                   TC2     EQU     $0054
   13:                                      
   14:          =000000CC                   SCI0SR1 EQU     $CC
   15:          =000000CF                   SCI0DRL EQU     $CF
   16:                                      
   17:          =00002000                           ORG     DATA
   18:     2000 +0001                       CMPT    DS.B    1
   19:                                      
   20:          =00001000                           ORG     CODE
   21:                                      
   22:     1000 CC 0064                [02] INIT    LDD     #$64
   23:     1003 7C 2000                [03]         STD     CMPT
   24:                                      
   25:     1006 86 80                  [01] INIT_TIMER      LDAA    #$80    ;On initialise le timer
   26:     1008 5A 46                  [02]         STAA    TSCR1   ;On met TEN à 1
   27:                                              
   28:     100A 86 04                  [01]         LDAA    #$04    ;
   29:     100C 5A 4D                  [02]         STAA    TSCR2   ;On met le prédiviseur à 16
   30:                                      
   31:     100E 86 04                  [01]         LDAA    #$04    ;
   32:     1010 5A 40                  [02]         STAA    TIOS    ;On met le le canal 3 en sortie sur comparaison
   33:                                              
   34:     1012 86 10                  [01]         LDAA    #$10    ;
   35:     1014 5A 49                  [02]         STAA    TCTL2   ;On met le basculement sur OC3
   36:                                      
   37:     1016 DC 44                  [03]         LDD     TCNT
   38:     1018 5C 54                  [02]         STD     TC2
   39:     101A F3 2000                [03] BOUCLE1 ADDD    CMPT    ;On ajoute 1000 pour avoir les millisecondes
   40:     101D 5C 54                  [02]         STD     TC2
   41:     101F 07 19                  [04]         BSR     AUVOL
   42:     1021 C1 2B                  [01]         CMPB    #'+'
   43:     1023 27 1F                  [03]         BEQ     INCR
   44:     1025 C1 2D                  [01]         CMPB    #'-'
   45:     1027 27 26                  [03]         BEQ     DECR
   46:     1029 96 4E                  [03] BOUCLE2 LDAA    TFLG1   ;On récupère les flags du timer
   47:     102B 84 04                  [01]         ANDA    #$04    ;On masque pour ne récupérer que C2I
   48:     102D 81 04                  [01]         CMPA    #$04    ;On teste
   49:     102F 26 F8                  [03]         BNE     BOUCLE2 ;Si il n'est pas activé, on recommence
   50:     1031 C6 04                  [01]         LDAB    #$04    ;
   51:     1033 5B 4E                  [02]         STAB    TFLG1   ;Si il est levé, on le remet à 0 en passant 1
   52:     1035 DC 54                  [03]         LDD     TC2
   53:     1037 20 E1                  [03]         BRA     BOUCLE1
   54:                                              
   55:     1039 3F                     [09]         SWI
   56:                                      
   57:                                      *---- Fonction AUVOL ----------------
   58:     103A 4F CC 20 05            [04] AUVOL   BRCLR   SCI0SR1,#$20,VIDE
   59:     103E D6 CF                  [03]         LDAB    SCI0DRL
   60:     1040 20 00                  [03]         BRA     FIN
   61:                                      
   62:     1042 3D                     [05] FIN     RTS
   63:                                      
   64:     1043 C7                     [01] VIDE    CLRB
   65:                                      *------------------------------------
   66:                                      
   67:                                      
   68:     1044 FC 2000                [03] INCR    LDD     CMPT
   69:     1047 C3 000A                [02]         ADDD    #$000A
   70:     104A 7C 2000                [03]         STD     CMPT
   71:     104D 20 DA                  [03]         BRA     BOUCLE2
   72:                                      
   73:     104F FC 2000                [03] DECR    LDD     CMPT
   74:     1052 83 000A                [02]         SUBD    #$000A
   75:     1055 7C 2000                [03]         STD     CMPT
   76:     1058 20 CF                  [03]         BRA     BOUCLE2

Symbols:
auvol                           *0000103a
boucle1                         *0000101a
boucle2                         *00001029
cmpt                            *00002000
code                            *00001000
data                            *00002000
decr                            *0000104f
fin                             *00001042
incr                            *00001044
sci0drl                         *000000cf
sci0sr1                         *000000cc
tc2                             *00000054
tcnt                            *00000044
tctl2                           *00000049
tflg1                           *0000004e
tios                            *00000040
tscr1                           *00000046
tscr2                           *0000004d
vide                            *00001043

