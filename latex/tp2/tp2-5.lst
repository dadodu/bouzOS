C:\Documents and Settings\dubusleo_UJF\Mes documents\µC\tp2-5.lst - generated by MGTEK Assembler ASM12 V1.26 Build 144 for WIN32 (x86) - Mon Mar 23 17:04:19 2015

    1:          =00001000              CODE    EQU     $1000
    2:          =00002000              DATA    EQU     $2000
    3:          =00000003              DDRB    EQU     $0003
    4:          =00000001              PORTB   EQU     $0001
    5:          =00000002              DDRA    EQU     $0002
    6:          =00000000              PORTA   EQU     $0000
    7:          =000000FF              SORTIE  EQU     $FF
    8:          =00000000              ENTREE  EQU     $00
    9:                                 
   10:          =00002000                      ORG     DATA
   11:     2000 32 32 2B 85 85 47      TABL    DC.B    $32,$32,$2B,$85,$85,$47 ;Les différents cas possibles
   12:                                                                 ;     feux voitures 3 et 4[R,O,V] - feux voitures 1 et 2[R,O,V] - feux piétons exclus [1 = rouge, 0 = vert]
   13:                                                                 ;#1 : 001                         - 100                         - 10
   14:                                                                 ;#2 : 001                         - 010                         - 11
   15:                                                                 ;#3 : 100                         - 001                         - 01
   16:                                                                 ;#4 : 010                         - 001                         - 11
   17:                                 
   18:                                 
   19:          =00001000                      ORG     CODE
   20:                                         
   21:     1000 86 FF                          LDAA    #SORTIE ;On initialise le port A en sortie
   22:     1002 5A 02                          STAA    DDRA    ;
   23:                                 
   24:     1004 CE 2000                MAIN    LDX     #TABL
   25:                                 
   26:     1007 A6 30                  BOUCLE  LDAA    1,X+
   27:     1009 5A 00                          STAA    PORTA
   28:                                 
   29:     100B 07 08                          BSR     TEMPO
   30:                                 
   31:     100D 8E 2006                        CPX     #TABL+6
   32:     1010 26 F5                          BNE     BOUCLE
   33:                                 
   34:     1012 20 F0                          BRA     MAIN
   35:                                 
   36:     1014 3F                             SWI
   37:                                         
   38:                                 *-- TEMPORISATION -----------------------------------
   39:     1015 C6 FA                  TEMPO   LDAB    #$FA    ;On commence la tempo
   40:     1017 CD C34F                REC2    LDY     #$C34F  ;Tempo à 50 000
   41:     101A 03                     REC1    DEY
   42:     101B 26 FD                          BNE     REC1
   43:     101D 53                             DECB
   44:     101E 26 F7                          BNE     REC2
   45:     1020 A7                             NOP             ;Tempo fini
   46:     1021 3D                             RTS
   47:                                 *----------------------------------------------------

Symbols:
boucle                          *00001007
code                            *00001000
data                            *00002000
ddra                            *00000002
main                            *00001004
porta                           *00000000
rec1                            *0000101a
rec2                            *00001017
sortie                          *000000ff
tabl                            *00002000
tempo                           *00001015

